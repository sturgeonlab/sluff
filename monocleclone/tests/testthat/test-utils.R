context('test-utils')


test_that("multi-core matrix multiply", {
  vunitary <- c(-0.10246245699996,0.349218795415387,0.107696065918671,-0.394864658044197,-0.36801741316425,0.535750468230825,0.212298377431117,0.0300448275234934,0.400051268724487,-0.267491020628564,-0.269939641256313,-0.0231580385439236,0.55136436398801,-0.032732849024305,0.531407373267012,-0.0938843482581937,0.118674208755819,0.44510586295317,0.336194959098801,0.0713041321039548,0.4141500858573,-0.279192347887995,0.12974013446896,0.18915818710894,0.149597140266033,0.72894054560801,0.0235870908389973,0.100952582191678,-0.128466753537641,0.341954546900345,0.252466568895385,-0.199078935598188,0.295690938432411,0.232821513518909,-0.00792258544714056,-0.00689400839817557,0.157348180517412,0.0744539438986995,-0.243816203116933,-0.81555548276894,-0.112349913865846,0.367289288643858,0.437864500944886,0.105567383864327,-0.27959115638877,0.0646571574506133,-0.645281939500741,0.18161641939188,-0.33809337664782,0.0597836287461683,-0.755123028567247,-0.17542120935256,-0.220129761192498,0.0196176297956683,0.107412745660028,0.331837791108866,0.115877044324329,0.0715806731378392,-0.445581344243441,-0.106896276039016,-0.262761805584117,-0.24635229665911,-0.0536170573417597,0.640009590212087,-0.203431238976266,0.105580791046781,-0.264291382463053,-0.130396792599892,0.55760324779765,-0.0864494205127029,0.0710113990109368,-0.00698243530774437,-0.220597106295783,-0.305171912826311,0.542330124852501,0.189939064711827,-0.594393984173097,-0.209080487272822,0.140174055594912,-0.32595890853921,0.00167896392364009,0.686917081025424,-0.0154874095106218,0.451153112109484,0.366289539214495,0.105654846509977,0.244355488085003,-0.338707396035591,-0.0667035231217706,-0.0122668921855083,0.156370960721993,0.248318025003313,-0.53681756398136,0.187651696161988,0.0185564812519676,0.00844704736401481,-0.0533948656714075,0.756104672068077,0.0557898800629559,-0.11147435536336)
  um <- matrix(vunitary, nrow=10)

  mmc1 <- matrix_multiply_multicore(um, t(um), 1)
  expect_equal(mmc1, diag(10))
  mmc2 <- matrix_multiply_multicore(um, t(um), 2)
  expect_equal(mmc2, diag(10))
} )

